{"remainingRequest":"/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/babel-loader/lib/index.js!/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/src/components/sys/basic/DepMana.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/src/components/sys/basic/DepMana.vue","mtime":1609308664000},{"path":"/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ckg/git 总代码/ChatRoom_OnLive/personal/rj_vue/rj_admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: \"DepMana\",\n  data: function data() {\n    return {\n      dialogVisible: false,\n      filterText: '',\n      dep: {\n        name: '',\n        parentId: -1\n      },\n      pname: '',\n      deps: [],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      }\n    };\n  },\n  watch: {\n    filterText: function filterText(val) {\n      this.$refs.tree.filter(val);\n    }\n  },\n  mounted: function mounted() {\n    this.initDeps();\n  },\n  methods: {\n    initDep: function initDep() {\n      this.dep = {\n        name: '',\n        parentId: -1\n      };\n      this.pname = '';\n    },\n    addDep2Deps: function addDep2Deps(deps, dep) {\n      for (var i = 0; i < deps.length; i++) {\n        var d = deps[i];\n\n        if (d.id == dep.parentId) {\n          d.children = d.children.concat(dep);\n\n          if (d.children.length > 0) {\n            d.parent = true;\n          }\n\n          return;\n        } else {\n          this.addDep2Deps(d.children, dep);\n        }\n      }\n    },\n    doAddDep: function doAddDep() {\n      var _this = this;\n\n      this.postRequest(\"/system/basic/department/\", this.dep).then(function (resp) {\n        if (resp) {\n          _this.addDep2Deps(_this.deps, resp.obj);\n\n          _this.dialogVisible = false; //初始化变量\n\n          _this.initDep();\n        }\n      });\n    },\n    removeDepFromDeps: function removeDepFromDeps(p, deps, id) {\n      for (var i = 0; i < deps.length; i++) {\n        var d = deps[i];\n\n        if (d.id == id) {\n          deps.splice(i, 1);\n\n          if (deps.length == 0) {\n            p.parent = false;\n          }\n\n          return;\n        } else {\n          this.removeDepFromDeps(d, d.children, id);\n        }\n      }\n    },\n    deleteDep: function deleteDep(data) {\n      var _this2 = this;\n\n      if (data.parent) {\n        this.$message.error(\"父部门删除失败\");\n      } else {\n        this.$confirm('此操作将永久删除【' + data.name + '】部门, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          _this2.deleteRequest(\"/system/basic/department/\" + data.id).then(function (resp) {\n            if (resp) {\n              _this2.removeDepFromDeps(null, _this2.deps, data.id);\n            }\n          });\n        }).catch(function () {\n          _this2.$message({\n            type: 'info',\n            message: '已取消删除'\n          });\n        });\n      }\n    },\n    showAddDepView: function showAddDepView(data) {\n      this.pname = data.name;\n      this.dep.parentId = data.id;\n      this.dialogVisible = true;\n    },\n    initDeps: function initDeps() {\n      var _this3 = this;\n\n      this.getRequest(\"/system/basic/department/\").then(function (resp) {\n        if (resp) {\n          _this3.deps = resp;\n        }\n      });\n    },\n    filterNode: function filterNode(value, data) {\n      if (!value) return true;\n      return data.name.indexOf(value) !== -1;\n    }\n  }\n};",{"version":3,"sources":["DepMana.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div style=\"width: 500px;\">\n        <el-input\n                placeholder=\"请输入部门名称进行搜索...\"\n                prefix-icon=\"el-icon-search\"\n                v-model=\"filterText\">\n        </el-input>\n\n        <el-tree\n                :data=\"deps\"\n                :props=\"defaultProps\"\n                :expand-on-click-node=\"false\"\n                :filter-node-method=\"filterNode\"\n                ref=\"tree\">\n            <span class=\"custom-tree-node\" style=\"display: flex;justify-content: space-between;width: 100%;\"\n                  slot-scope=\"{ node, data }\">\n        <span>{{data.name }}</span>\n        <span>\n          <el-button\n                  type=\"primary\"\n                  size=\"mini\"\n                  class=\"depBtn\"\n                  @click=\"() => showAddDepView(data)\">\n            添加部门\n          </el-button>\n          <el-button\n                  type=\"danger\"\n                  size=\"mini\"\n                  class=\"depBtn\"\n                  @click=\"() => deleteDep(data)\">\n            删除部门\n          </el-button>\n        </span>\n      </span>\n        </el-tree>\n        <el-dialog\n                title=\"添加部门\"\n                :visible.sync=\"dialogVisible\"\n                width=\"30%\">\n            <div>\n                <table>\n                    <tr>\n                        <td>\n                            <el-tag>上级部门</el-tag>\n                        </td>\n                        <td>{{pname}}</td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <el-tag>部门名称</el-tag>\n                        </td>\n                        <td>\n                            <el-input v-model=\"dep.name\" placeholder=\"请输入部门名称...\"></el-input>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <span slot=\"footer\" class=\"dialog-footer\">\n    <el-button @click=\"dialogVisible = false\">取 消</el-button>\n    <el-button type=\"primary\" @click=\"doAddDep\">确 定</el-button>\n  </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"DepMana\",\n        data() {\n            return {\n                dialogVisible: false,\n                filterText: '',\n                dep: {\n                    name: '',\n                    parentId: -1\n                },\n                pname: '',\n                deps: [],\n                defaultProps: {\n                    children: 'children',\n                    label: 'name'\n                }\n            }\n        },\n        watch: {\n            filterText(val) {\n                this.$refs.tree.filter(val);\n            }\n        },\n        mounted() {\n            this.initDeps();\n        },\n        methods: {\n            initDep() {\n                this.dep = {\n                    name: '',\n                    parentId: -1\n                }\n                this.pname = '';\n            },\n            addDep2Deps(deps, dep) {\n                for (let i = 0; i < deps.length; i++) {\n                    let d = deps[i];\n                    if (d.id == dep.parentId) {\n                        d.children = d.children.concat(dep);\n                        if (d.children.length > 0) {\n                            d.parent = true;\n                        }\n                        return;\n                    } else {\n                        this.addDep2Deps(d.children, dep);\n                    }\n                }\n            },\n            doAddDep() {\n                this.postRequest(\"/system/basic/department/\", this.dep).then(resp => {\n                    if (resp) {\n                        this.addDep2Deps(this.deps, resp.obj);\n                        this.dialogVisible = false;\n                        //初始化变量\n                        this.initDep();\n                    }\n                })\n            },\n            removeDepFromDeps(p,deps, id) {\n                for(let i=0;i<deps.length;i++){\n                    let d = deps[i];\n                    if (d.id == id) {\n                        deps.splice(i, 1);\n                        if (deps.length == 0) {\n                            p.parent = false;\n                        }\n                        return;\n                    }else{\n                        this.removeDepFromDeps(d,d.children, id);\n                    }\n                }\n            },\n            deleteDep(data) {\n                if (data.parent) {\n                    this.$message.error(\"父部门删除失败\");\n                } else {\n                    this.$confirm('此操作将永久删除【' + data.name + '】部门, 是否继续?', '提示', {\n                        confirmButtonText: '确定',\n                        cancelButtonText: '取消',\n                        type: 'warning'\n                    }).then(() => {\n                       this.deleteRequest(\"/system/basic/department/\"+data.id).then(resp=>{\n                           if (resp) {\n                               this.removeDepFromDeps(null,this.deps,data.id);\n                           }\n                       })\n                    }).catch(() => {\n                        this.$message({\n                            type: 'info',\n                            message: '已取消删除'\n                        });\n                    });\n                }\n            },\n            showAddDepView(data) {\n                this.pname = data.name;\n                this.dep.parentId = data.id;\n                this.dialogVisible = true;\n            },\n            initDeps() {\n                this.getRequest(\"/system/basic/department/\").then(resp => {\n                    if (resp) {\n                        this.deps = resp;\n                    }\n                })\n            },\n            filterNode(value, data) {\n                if (!value) return true;\n                return data.name.indexOf(value) !== -1;\n            }\n        }\n    }\n</script>\n\n<style>\n    .depBtn {\n        padding: 2px;\n    }\n</style>"],"sourceRoot":"src/components/sys/basic"}]}